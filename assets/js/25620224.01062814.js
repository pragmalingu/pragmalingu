(self.webpackChunkpragmalingu_github_io=self.webpackChunkpragmalingu_github_io||[]).push([[729],{3905:function(e,t,n){"use strict";n.d(t,{Zo:function(){return p},kt:function(){return u}});var r=n(7294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var s=r.createContext({}),m=function(e){var t=r.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},p=function(e){var t=m(e.components);return r.createElement(s.Provider,{value:t},e.children)},h={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},c=r.forwardRef((function(e,t){var n=e.components,a=e.mdxType,i=e.originalType,s=e.parentName,p=l(e,["components","mdxType","originalType","parentName"]),c=m(n),u=a,d=c["".concat(s,".").concat(u)]||c[u]||h[u]||i;return n?r.createElement(d,o(o({ref:t},p),{},{components:n})):r.createElement(d,o({ref:t},p))}));function u(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var i=n.length,o=new Array(i);o[0]=c;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l.mdxType="string"==typeof e?e:a,o[1]=l;for(var m=2;m<i;m++)o[m]=n[m];return r.createElement.apply(null,o)}return r.createElement.apply(null,n)}c.displayName="MDXCreateElement"},3919:function(e,t,n){"use strict";function r(e){return!0===/^(\w*:|\/\/)/.test(e)}function a(e){return void 0!==e&&!r(e)}n.d(t,{b:function(){return r},Z:function(){return a}})},4996:function(e,t,n){"use strict";n.d(t,{C:function(){return i},Z:function(){return o}});var r=n(2263),a=n(3919);function i(){var e=(0,r.Z)().siteConfig,t=(e=void 0===e?{}:e).baseUrl,n=void 0===t?"/":t,i=e.url;return{withBaseUrl:function(e,t){return function(e,t,n,r){var i=void 0===r?{}:r,o=i.forcePrependBaseUrl,l=void 0!==o&&o,s=i.absolute,m=void 0!==s&&s;if(!n)return n;if(n.startsWith("#"))return n;if((0,a.b)(n))return n;if(l)return t+n;var p=n.startsWith(t)?n:t+n.replace(/^\//,"");return m?e+p:p}(i,n,e,t)}}}function o(e,t){return void 0===t&&(t={}),(0,i().withBaseUrl)(e,t)}},3071:function(e,t,n){"use strict";n.r(t),n.d(t,{frontMatter:function(){return l},contentTitle:function(){return s},metadata:function(){return m},toc:function(){return p},default:function(){return c}});var r=n(2122),a=n(9756),i=(n(7294),n(3905)),o=n(4996),l={id:"stemming",title:"Simple Search vs. Stemming",author:"Samy Ateia and Miriam Rupprecht",date:"April 2021",sidebar_label:"Stemming",custom_edit_url:null,description:"A Comparison of different stemming approaches in Elasticsearch",keywords:["stemming","hunspell stemmer","algorithmic stemming","Elasticsearch"]},s=void 0,m={unversionedId:"comparisons/stemming",id:"comparisons/stemming",isDocsHomePage:!1,title:"Simple Search vs. Stemming",description:"A Comparison of different stemming approaches in Elasticsearch",source:"@site/docs/comparisons/stemming.mdx",sourceDirName:"comparisons",slug:"/comparisons/stemming",permalink:"/docs/comparisons/stemming",editUrl:null,version:"current",frontMatter:{id:"stemming",title:"Simple Search vs. Stemming",author:"Samy Ateia and Miriam Rupprecht",date:"April 2021",sidebar_label:"Stemming",custom_edit_url:null,description:"A Comparison of different stemming approaches in Elasticsearch",keywords:["stemming","hunspell stemmer","algorithmic stemming","Elasticsearch"]},sidebar:"comparisons",previous:{title:"Introduction",permalink:"/docs/comparisons/comparisons-intro"},next:{title:"Decomposition",permalink:"/docs/comparisons/german-decomposition"}},p=[{value:"1. What is Stemming?",id:"1-what-is-stemming",children:[{value:"Algorithmic Stemming",id:"algorithmic-stemming",children:[]},{value:"Dictionary Based Stemming",id:"dictionary-based-stemming",children:[]},{value:"Comparison",id:"comparison",children:[]}]},{value:"2. Results",id:"2-results",children:[]},{value:"3. Discussion",id:"3-discussion",children:[{value:"3.1 Algorithmic Stemmer improvements over the Standard Analyzer",id:"31-algorithmic-stemmer-improvements-over-the-standard-analyzer",children:[]},{value:"3.2 Hunspell Stemmer improvements over the Algorithmic Stemmer:",id:"32-hunspell-stemmer-improvements-over-the-algorithmic-stemmer",children:[]},{value:"3.3 Algorithmic Stemmer improvements over the Hunspell Stemmer:",id:"33-algorithmic-stemmer-improvements-over-the-hunspell-stemmer",children:[]},{value:"3.4 Standard Analyzer improvements over the Hunspell Stemmer:",id:"34-standard-analyzer-improvements-over-the-hunspell-stemmer",children:[]}]},{value:"4. Conclusion",id:"4-conclusion",children:[]}],h={toc:p};function c(e){var t=e.components,n=(0,a.Z)(e,["components"]);return(0,i.kt)("wrapper",(0,r.Z)({},h,n,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h2",{id:"1-what-is-stemming"},"1. What is Stemming?"),(0,i.kt)("p",null,"Stemming is the process of removing the alternating endings from words. Words with the same meaning, but different endings can then be matched better.  For example, The words ",(0,i.kt)("strong",{parentName:"p"},"fish"),", ",(0,i.kt)("strong",{parentName:"p"},"fishing"),", and ",(0,i.kt)("strong",{parentName:"p"},"fished")," would all be reduced to their common word stem ",(0,i.kt)("strong",{parentName:"p"},"fish"),". For the usage in a search engine, this stem is then stored in the ",(0,i.kt)("a",{parentName:"p",href:"https://en.wikipedia.org/wiki/Search_engine_indexing#Inverted_indices"},"inverted index")," instead of the original word at that position.\nWhen you search with any of the original words, your query is also stemmed and the search engine can find all documents that contain words with the same stem. This way, more relevant documents are found since the search query does not only rely on the given word forms but also matches the same word with different endings."),(0,i.kt)("p",null,"There are two common approaches to implement stemming in search engines.  "),(0,i.kt)("h3",{id:"algorithmic-stemming"},"Algorithmic Stemming"),(0,i.kt)("p",null,"The ",(0,i.kt)("a",{parentName:"p",href:"https://snowballstem.org/algorithms/porter/stemmer.html"},"Porter stemming algorithm"),", created by ",(0,i.kt)("a",{parentName:"p",href:"https://en.wikipedia.org/wiki/Martin_Porter"},"Martin Porter"),", is one of the most popular algorithmic stemmers and is used by default in the built-in ",(0,i.kt)("a",{parentName:"p",href:"https://www.elastic.co/guide/en/elasticsearch/reference/7.12/analysis-stemmer-tokenfilter.html"},"language analyzers")," in Elasticsearch.\nAlgorithmic stemmers are very fast and do not require a lot of memory as they only apply a set of rules that represents the common rules on how words are ",(0,i.kt)("a",{parentName:"p",href:"https://en.wikipedia.org/wiki/Inflection"},"inflected")," in a specific language.",(0,i.kt)("br",{parentName:"p"}),"\n","Because there are always exceptions in natural language, an algorithmic stemmer might produce the same stem for words that have different meanings.\nThis error is called ",(0,i.kt)("a",{parentName:"p",href:"https://en.wikipedia.org/wiki/Stemming#Error_metrics"},(0,i.kt)("strong",{parentName:"a"},"overstemming")),".\nAnother error that can happen is called ",(0,i.kt)("a",{parentName:"p",href:"https://en.wikipedia.org/wiki/Stemming#Error_metrics"},(0,i.kt)("strong",{parentName:"a"},"understemming"))," and happens when two inflected words with different endings but the same meaning and stem are not reduced to the same stem."),(0,i.kt)("h3",{id:"dictionary-based-stemming"},"Dictionary Based Stemming"),(0,i.kt)("p",null,"The second approach to stemming is ",(0,i.kt)("a",{parentName:"p",href:"https://www.elastic.co/guide/en/elasticsearch/reference/current/stemming.html#dictionary-stemmers"},"dictionary-based stemming"),".\nDictionary stemmers look up words in a dictionary before they remove their inflected endings and reduce them to their stem. This approach should work better on irregular words or words that are similar but have different meanings. Dictionary stemmers should be able to reduce over- and understemming and achieve better results than algorithmic stemmers. In practice, they sometimes perform worse than algorithmic stemmers because freely available dictionaries are never complete and are often missing important words or are outdated. Dictionary stemmers also have the drawback that they are slower and require more memory as they have to look up all the words in their dictionary."),(0,i.kt)("h3",{id:"comparison"},"Comparison"),(0,i.kt)("p",null,"In this comparison we will answer the following questions:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"How much does the relevancy of search results improve by using a stemmer?"),(0,i.kt)("li",{parentName:"ul"},"How well does the Hunspell stemmer that is included in Elasticsearch perform with a free dictionary?")),(0,i.kt)("h2",{id:"2-results"},"2. Results"),(0,i.kt)("p",null,"The following results are from our ",(0,i.kt)("a",{parentName:"p",href:"../experiments/experiment1"},"First Experiment"),". You can reproduce these results yourself if you follow the instructions in our ",(0,i.kt)("a",{parentName:"p",href:"../experiments/experiments-intro"},"experiment section"),".\nWe calculated ",(0,i.kt)("a",{parentName:"p",href:"https://en.wikipedia.org/wiki/Precision_and_recall"},"Precision and Recall")," at k=20 for several datasets and show the resulting F1-score. "),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"F1-Score")),(0,i.kt)("details",null,(0,i.kt)("summary",null,'What is an "F1-Score"?'),(0,i.kt)("p",null,"The F1-Score measures a harmonic mean between ",(0,i.kt)("a",{parentName:"p",href:"https://en.wikipedia.org/wiki/Precision_and_recall"},"Precision and Recall"),". Therefore, we multiply Precision and Recall by two and divide it by the sum of Precision and Recall:",(0,i.kt)("br",{parentName:"p"}),"\n",(0,i.kt)("inlineCode",{parentName:"p"},"F1-Score=(2*Precision*Recall)/(Precision+Recall)"),(0,i.kt)("br",{parentName:"p"}),"\n","This is the simplest way to balance both Precision and Recall, there are also other common options to weight them differently.")),(0,i.kt)("img",{alt:"F1-Score",src:(0,o.Z)("img/EXP1_FScore.svg")}),(0,i.kt)("a",{className:"buttons",href:"https://colab.research.google.com/github/pragmalingu/experiments/blob/master/01_Stemming/Evaluation/Comparison_Stemming_vs_Standard_Search.ipynb#scrollTo=F_WKHLDXJypJ"},(0,i.kt)("button",{className:"buttons"},"Reproduce it in Google Colab")),(0,i.kt)("br",null),(0,i.kt)("br",null),(0,i.kt)("p",null,"On all evaluation datasets except NPL, the Algorithmic Stemmer outperformed the Standard Analyzer as well as the Hunspell Token Filter.\nThe achieved F1-Score gains - measured in percentage points - with the Standard Analyzer as the baseline can be seen here:"),(0,i.kt)("img",{alt:"F1-Score Gains",src:(0,o.Z)("img/EXP1_Gains.svg")}),(0,i.kt)("br",null),(0,i.kt)("br",null),(0,i.kt)("p",null,"Depending on the use-case, algorithmic stemming can create up to a ",(0,i.kt)("strong",{parentName:"p"},"22% improvement")," in the relevance of the search results. Hunspell stemming performs worse than algorithmic stemming on nearly all datasets and can even lead to worse results than no stemming."),(0,i.kt)("p",null,"The average F1-Score gains across all datasets are:"),(0,i.kt)("img",{alt:"F1-Score Gains",src:(0,o.Z)("img/EXP1_Average.svg")}),(0,i.kt)("p",null,"Using the Stemmer Token Filter on English documents can therefore improve the F1-Score by an average of 11%."),(0,i.kt)("h2",{id:"3-discussion"},"3. Discussion"),(0,i.kt)("p",null,"Looking at the F1-Score from our approaches we can see that both stemming approaches perform better than the standard baseline on most of the datasets. The Algorithmic Stemmer performs better than the Standard Analyzer with the largest gains on the CACM and NPL corpora. The Hunspell Stemmer performs worse than the Algorithmic Stemmer on most of the datasets except the NPL dataset, where it performs slightly better. On the Medline corpus, the Hunspell Stemmer performs even worse than the Standard Analyzer."),(0,i.kt)("p",null,"There are several interesting questions that we can ask based on these results:"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},"Why does the Algorithmic Stemmer perform better than the Standard Analyzer?"),(0,i.kt)("li",{parentName:"ol"},"Why does the Algorithmic Stemmer perform better than the Hunspell Stemmer?"),(0,i.kt)("li",{parentName:"ol"},"Why does the Hunspell Stemmer perform worse than the Standard Analyzer on the Medline dataset?"),(0,i.kt)("li",{parentName:"ol"},"Why does the Hunspell Stemmer perform better than the Algorithmic Stemmer on the NPL dataset?")),(0,i.kt)("p",null,"We will try to answer these questions by breaking down the results of the individual query and word matches.",(0,i.kt)("br",{parentName:"p"}),"\n","You can follow all steps in detail and reproduce the results by running our ",(0,i.kt)("a",{parentName:"p",href:"https://colab.research.google.com/github/pragmalingu/experiments/blob/master/01_Stemming/Evaluation/Comparison_Stemming_vs_Standard_Search.ipynb#scrollTo=X33-_O4rPMso"},"comparison notebook"),"."),(0,i.kt)("h3",{id:"31-algorithmic-stemmer-improvements-over-the-standard-analyzer"},"3.1 Algorithmic Stemmer improvements over the Standard Analyzer"),(0,i.kt)("p",null,"We can see from the gains that the Algorithmic Stemmer performs better than the Standard Analyzer on all tested datasets.\nBut how does the Algorithmic Stemmer achieve these results?"),(0,i.kt)("p",null,"We can answer this by looking at the NPL dataset which shows a significant gain of ",(0,i.kt)("strong",{parentName:"p"},"19.65%")," for the Stemmer Token Filter over the Standard Analyzer."),(0,i.kt)("p",null,"We first used our search analysis tool to figure out the queries that demonstrate ",(0,i.kt)("a",{parentName:"p",href:"https://colab.research.google.com/github/pragmalingu/experiments/blob/master/01_Stemming/Evaluation/Comparison_Stemming_vs_Standard_Search.ipynb#scrollTo=_fC_-pb7G4HM"},"the largest F1-Score improvements")," with the Stemmer Token Filter.\nThe three queries with the biggest F1-Score difference are ",(0,i.kt)("strong",{parentName:"p"},"62"),", ",(0,i.kt)("strong",{parentName:"p"},"73"),", and ",(0,i.kt)("strong",{parentName:"p"},"52"),". We will be looking at query ",(0,i.kt)("strong",{parentName:"p"},"62"),"."),(0,i.kt)("p",null,"The query text of query 63 is:  "),(0,i.kt)("blockquote",null,(0,i.kt)("p",{parentName:"blockquote"},"FAST TRANSISTOR COUNTERS.")),(0,i.kt)("p",null,"We first looked at the disjoint true positives sets of the query results for both the Algorithmic Stemmer and the Standard Analyzer.\nThe highest-ranked document for the Algorithmic Stemmer that is not present in the top ",(0,i.kt)("strong",{parentName:"p"},"k=20")," results of the Standard Analyzer is ",(0,i.kt)("a",{parentName:"p",href:"https://colab.research.google.com/github/pragmalingu/experiments/blob/master/01_Stemming/Evaluation/Comparison_Stemming_vs_Standard_Search.ipynb#scrollTo=QjP7C2guRRhm"},"document ",(0,i.kt)("inlineCode",{parentName:"a"},"8341")),". For the Standard Analyzer, this document ",(0,i.kt)("a",{parentName:"p",href:"https://colab.research.google.com/github/pragmalingu/experiments/blob/master/01_Stemming/Evaluation/Comparison_Stemming_vs_Standard_Search.ipynb#scrollTo=1JMpo-U2SWEW"},"appears at position 34")," which is outside the ",(0,i.kt)("strong",{parentName:"p"},"k=20")," result set that we used to calculate precision and recall."),(0,i.kt)("p",null,"The text of the relevant document is: "),(0,i.kt)("blockquote",null,(0,i.kt)("p",{parentName:"blockquote"},"nonsaturating pulse circuits using two junction transistors junction transistors are found to be fast enough for pulse applications if the collector voltage is\nprevented from reaching zero switching times can be achieved with available types the required limiting action is effected by introducing diodes which terminate\nthe switching transients by their breakdown a two transistor binary counter is described")),(0,i.kt)("p",null,"For the ",(0,i.kt)("strong",{parentName:"p"},"Algorithmic Stemmer")," the document is at position ",(0,i.kt)("strong",{parentName:"p"},"3")," and returns the following highlighted text:"),(0,i.kt)("blockquote",null,(0,i.kt)("p",{parentName:"blockquote"},"nonsaturating pulse circuits using two junction ",(0,i.kt)("strong",{parentName:"p"},"transistors"),"  junction ",(0,i.kt)("strong",{parentName:"p"},"transistors")," are found to be ",(0,i.kt)("strong",{parentName:"p"},"fast")," (...)  a two ",(0,i.kt)("strong",{parentName:"p"},"transistor")," binary ",(0,i.kt)("strong",{parentName:"p"},"counter")," is described")),(0,i.kt)("p",null,"The overall document score of ",(0,i.kt)("strong",{parentName:"p"},"12.49")," is the sum of these individual term scores:"),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:null},"Term"),(0,i.kt)("th",{parentName:"tr",align:null},"Score"),(0,i.kt)("th",{parentName:"tr",align:null},"Term Frequency"),(0,i.kt)("th",{parentName:"tr",align:null},"Document Frequency"))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"fast"),(0,i.kt)("td",{parentName:"tr",align:null},"4.31"),(0,i.kt)("td",{parentName:"tr",align:null},"1"),(0,i.kt)("td",{parentName:"tr",align:null},"84")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"transistor"),(0,i.kt)("td",{parentName:"tr",align:null},"4.22"),(0,i.kt)("td",{parentName:"tr",align:null},"3"),(0,i.kt)("td",{parentName:"tr",align:null},"640")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"counter"),(0,i.kt)("td",{parentName:"tr",align:null},"3.95"),(0,i.kt)("td",{parentName:"tr",align:null},"1"),(0,i.kt)("td",{parentName:"tr",align:null},"127")))),(0,i.kt)("p",null,"For the ",(0,i.kt)("strong",{parentName:"p"},"Standard Analyzer")," the same document is at position ",(0,i.kt)("strong",{parentName:"p"},"34")," and returns the following highlighted text:"),(0,i.kt)("blockquote",null,(0,i.kt)("p",{parentName:"blockquote"},"nonsaturating pulse circuits using two junction transistors  junction transistors are found to be ",(0,i.kt)("strong",{parentName:"p"},"fast")," is effected by introducing diodes which terminate the switching transients by their breakdown  a two ",(0,i.kt)("strong",{parentName:"p"},"transistor"))),(0,i.kt)("p",null,"The overall document score of ",(0,i.kt)("strong",{parentName:"p"},"7.10")," is the sum of these individual term scores:"),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:null},"Term"),(0,i.kt)("th",{parentName:"tr",align:null},"Score"),(0,i.kt)("th",{parentName:"tr",align:null},"Term Frequency"),(0,i.kt)("th",{parentName:"tr",align:null},"Document Frequency"))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"fast"),(0,i.kt)("td",{parentName:"tr",align:null},"4.31"),(0,i.kt)("td",{parentName:"tr",align:null},"1"),(0,i.kt)("td",{parentName:"tr",align:null},"84")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"transistor"),(0,i.kt)("td",{parentName:"tr",align:null},"2.78"),(0,i.kt)("td",{parentName:"tr",align:null},"1"),(0,i.kt)("td",{parentName:"tr",align:null},"479")))),(0,i.kt)("p",null,"We can see that for the Standard Analyzer the inflected word ",(0,i.kt)("strong",{parentName:"p"},"counters")," is not matched with the word ",(0,i.kt)("strong",{parentName:"p"},"counter")," in the document. The occurrences of the word ",(0,i.kt)("strong",{parentName:"p"},"transistors")," are also not matched with the stem ",(0,i.kt)("strong",{parentName:"p"},"transistor")," used in the query and, therefore, the term frequency and score of the word are lower.\nThe document frequency is also lower, which normally leads to a higher score, but cannot make up for the lower term frequency in this instance."),(0,i.kt)("img",{alt:"NPL: matched terms in document 8342 for query 62",src:(0,o.Z)("img/EXP1_Query_62_explain.svg")}),(0,i.kt)("h3",{id:"32-hunspell-stemmer-improvements-over-the-algorithmic-stemmer"},"3.2 Hunspell Stemmer improvements over the Algorithmic Stemmer:"),(0,i.kt)("p",null,"The NPL dataset is also the only dataset where our Hunspell Token Filter performed slightly better than the Algorithmic Stemmer. We can use our search analysis tool again to extract relevant examples from the datasets that show how the ",(0,i.kt)("a",{parentName:"p",href:"https://colab.research.google.com/github/pragmalingu/experiments/blob/master/01_Stemming/Evaluation/Comparison_Stemming_vs_Standard_Search.ipynb#scrollTo=dkAJ64J3UnC_"},"Hunspell Stemmer achieves better results"),"."),(0,i.kt)("p",null,"We again started by calculating the F1-Score differences for all queries between the Hunspell stemmer and the Algorithmic Stemmer.\nLikewise, we picked the query that showed the biggest F1-Score difference favoring the Hunspell Stemmer, which is query ",(0,i.kt)("inlineCode",{parentName:"p"},"80"),"."),(0,i.kt)("p",null,"The query text of query 80 is: "),(0,i.kt)("blockquote",null,(0,i.kt)("p",{parentName:"blockquote"},"COULD YOU PLEASE GIVE ME ARTICLES ABOUT THE POSSIBILITIES OF GETTING RECTIFICATION USING METALLIC DEVICES.")),(0,i.kt)("p",null,"If we look at the disjoint set of true positives, we can see that the Hunspell Stemmer finds document ",(0,i.kt)("inlineCode",{parentName:"p"},"8094")," at position ",(0,i.kt)("inlineCode",{parentName:"p"},"1"),", while the Algorithmic Stemmer ranks this document at position ",(0,i.kt)("inlineCode",{parentName:"p"},"130"),"."),(0,i.kt)("p",null,"The text of document ",(0,i.kt)("inlineCode",{parentName:"p"},"8094")," is:"),(0,i.kt)("blockquote",null,(0,i.kt)("p",{parentName:"blockquote"},"component design trends metallic rectifiers approach infinite life developments in cu se si ge and rectifiers are surveyed new designs give reduced size and longer life together with higher operating temperature output current and reverse voltage ratings")),(0,i.kt)("p",null,"As we can see, there are some strange tokens in the text: ",(0,i.kt)("inlineCode",{parentName:"p"},"cu se si ge"),". We double-checked the original files of the dataset to ensure that it is actually in the files and not an artifact of our processing."),(0,i.kt)("p",null,"The Hunspell Stemmer returns the following highlighted text:"),(0,i.kt)("blockquote",null,(0,i.kt)("p",{parentName:"blockquote"},"component design trends ",(0,i.kt)("strong",{parentName:"p"},"metallic")," ",(0,i.kt)("strong",{parentName:"p"},"rectifiers")," approach infinite life developments in cu se si ge and ",(0,i.kt)("strong",{parentName:"p"},"rectifiers")," are surveyed new designs ",(0,i.kt)("strong",{parentName:"p"},"give")," reduced size and longer life together with higher operating temperature'")),(0,i.kt)("p",null,"The overall document score with the Hunspell Stemmer of ",(0,i.kt)("strong",{parentName:"p"},"16.61")," is the sum of these individual term scores:"),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:null},"Term"),(0,i.kt)("th",{parentName:"tr",align:null},"Score"),(0,i.kt)("th",{parentName:"tr",align:null},"Term Frequency"),(0,i.kt)("th",{parentName:"tr",align:null},"Document Frequency"))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"g or give"),(0,i.kt)("td",{parentName:"tr",align:null},"4.74"),(0,i.kt)("td",{parentName:"tr",align:null},"2"),(0,i.kt)("td",{parentName:"tr",align:null},"426")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"rectification or  rectify"),(0,i.kt)("td",{parentName:"tr",align:null},"5.98"),(0,i.kt)("td",{parentName:"tr",align:null},"2"),(0,i.kt)("td",{parentName:"tr",align:null},"180")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"metallic"),(0,i.kt)("td",{parentName:"tr",align:null},"5.88"),(0,i.kt)("td",{parentName:"tr",align:null},"1"),(0,i.kt)("td",{parentName:"tr",align:null},"47")))),(0,i.kt)("p",null,"The Algorithmic Stemmer on the other hand returns the following highlighted text:"),(0,i.kt)("blockquote",null,(0,i.kt)("p",{parentName:"blockquote"},"component design trends ",(0,i.kt)("strong",{parentName:"p"},"metallic")," rectifiers approach infinite life developments in cu se si ge and rectifiers are surveyed new designs ",(0,i.kt)("strong",{parentName:"p"},"give")," reduced size and longer life together with higher operating temperature")),(0,i.kt)("p",null,"The overall document score with the algorithmic stemmer of ",(0,i.kt)("strong",{parentName:"p"},"7.27")," is the sum of these individual term scores:"),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:null},"Term"),(0,i.kt)("th",{parentName:"tr",align:null},"Score"),(0,i.kt)("th",{parentName:"tr",align:null},"Term Frequency"),(0,i.kt)("th",{parentName:"tr",align:null},"Document Frequency"))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"give"),(0,i.kt)("td",{parentName:"tr",align:null},"3.45"),(0,i.kt)("td",{parentName:"tr",align:null},"1"),(0,i.kt)("td",{parentName:"tr",align:null},"426")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"metal"),(0,i.kt)("td",{parentName:"tr",align:null},"3.82"),(0,i.kt)("td",{parentName:"tr",align:null},"1"),(0,i.kt)("td",{parentName:"tr",align:null},"300")))),(0,i.kt)("img",{alt:"Matched Terms in document 8094 for query 80",src:(0,o.Z)("img/EXP1_Query_80_explain.svg")}),(0,i.kt)("p",null,"These results show us that the Algorithmic Stemmer is missing the hit on the search term ",(0,i.kt)("strong",{parentName:"p"},"RECTIFICATION")," which appears in the document as ",(0,i.kt)("strong",{parentName:"p"},"rectifiers"),".\nWe also see that the keyword ",(0,i.kt)("strong",{parentName:"p"},"metallic")," receives a better (lower) document frequency with the Hunspell Stemmer because it is not stemmed to ",(0,i.kt)("strong",{parentName:"p"},"metal"),"."),(0,i.kt)("p",null,"Why doesn't the Algorithmic Stemmer match ",(0,i.kt)("strong",{parentName:"p"},"rectification")," with ",(0,i.kt)("strong",{parentName:"p"},"rectifiers"),"? We can use the Analyze API endpoint of Elasticsearch to see how the Algorithmic Stemmer handles these words:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},'POST /pragmalingu-stemming-npl-corpus/_analyze\n{\n  "text": "rectification rectifiers rectify"\n}\n# Response:\n{\n  "tokens" : [\n    {\n      "token" : "rectif",\n      "start_offset" : 0,\n      "end_offset" : 13,\n      "type" : "<ALPHANUM>",\n      "position" : 0\n    },\n    {\n      "token" : "rectifi",\n      "start_offset" : 14,\n      "end_offset" : 24,\n      "type" : "<ALPHANUM>",\n      "position" : 1\n    },\n    {\n      "token" : "rectifi",\n      "start_offset" : 25,\n      "end_offset" : 32,\n      "type" : "<ALPHANUM>",\n      "position" : 2\n    }\n  ]\n}\n')),(0,i.kt)("p",null,"Here we can see that ",(0,i.kt)("strong",{parentName:"p"},"rectification")," gets overstemmed to ",(0,i.kt)("strong",{parentName:"p"},"rectif")," instead of ",(0,i.kt)("strong",{parentName:"p"},"rectifi")," and is, therefore, not matched with the other tokens."),(0,i.kt)("p",null,"But how exactly does the Hunspell Stemmer manage to match this keyword?\nWe can also look at the output of the Analyze API endpoint to answer this question:"),(0,i.kt)("p",null,"Request:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},'POST /pragmalingu-hunspell-npl-corpus/_analyze\n{\n  "text": "rectification rectifiers rectify"\n}\n')),(0,i.kt)("p",null,"Response:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},'{\n  "tokens" : [\n    {\n      "token" : "rectification",\n      "start_offset" : 0,\n      "end_offset" : 13,\n      "type" : "<ALPHANUM>",\n      "position" : 0\n    },\n    {\n      "token" : "rectify",\n      "start_offset" : 0,\n      "end_offset" : 13,\n      "type" : "<ALPHANUM>",\n      "position" : 0\n    },\n    {\n      "token" : "rectify",\n      "start_offset" : 14,\n      "end_offset" : 24,\n      "type" : "<ALPHANUM>",\n      "position" : 1\n    },\n    {\n      "token" : "rectify",\n      "start_offset" : 25,\n      "end_offset" : 32,\n      "type" : "<ALPHANUM>",\n      "position" : 2\n    }\n  ]\n}\n')),(0,i.kt)("p",null,'How does the Hunspell stemmer find the keyword "rectifiers"?'),(0,i.kt)("p",null,"We can see that the search term ",(0,i.kt)("strong",{parentName:"p"},"rectification")," gets expanded to the following ",(0,i.kt)("a",{parentName:"p",href:"https://lucene.apache.org/core/8_8_2/core/org/apache/lucene/search/SynonymQuery.html"},"synonym query"),": ",(0,i.kt)("inlineCode",{parentName:"p"},"Synonym(text:rectification text:rectify)"),".\nThis means that Elasticsearch is looking up both terms at the same position, combining their term frequency, and using the highest document frequency for the score.\n",(0,i.kt)("strong",{parentName:"p"},"Rectify")," seems to be the stem that the Hunspell Token Filter found in ",(0,i.kt)("a",{parentName:"p",href:"https://cgit.freedesktop.org/libreoffice/dictionaries/plain/en/en_US.dic"},"its dictionary")," for the word ",(0,i.kt)("strong",{parentName:"p"},"rectification")," and also ",(0,i.kt)("strong",{parentName:"p"},"rectifiers"),". If we look at the ",(0,i.kt)("a",{parentName:"p",href:"https://cgit.freedesktop.org/libreoffice/dictionaries/plain/en/en_US.dic"},"Hunspell dictionary")," we find the following entry: ",(0,i.kt)("inlineCode",{parentName:"p"},"rectify/XNDRSZG"),",\nTo understand these letters, we can look at the corresponding ",(0,i.kt)("a",{parentName:"p",href:"https://cgit.freedesktop.org/libreoffice/dictionaries/plain/en/en_US.aff"},"suffix rules")," that enable the Hunspell stemmer to match these words."),(0,i.kt)("p",null,"The first relevant rule here is ",(0,i.kt)("strong",{parentName:"p"},"N"),":"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"SFX N Y 3  \nSFX N e ion e  \nSFX N y ication y  \nSFX N 0 en [^ey]\n")),(0,i.kt)("p",null,"There is a good explanation of how these Hunspell dictionaries and affix files work and what the individual columns in the rules mean on the ",(0,i.kt)("a",{parentName:"p",href:"https://www.chromium.org/developers/how-tos/editing-the-spell-checking-dictionaries#TOC-Full-details"},"Chromium developer documentation site"),"."),(0,i.kt)("p",null,"The third line ",(0,i.kt)("inlineCode",{parentName:"p"},"SFX N y ication y")," enables the matching of rectification."),(0,i.kt)("p",null,"But in the text ",(0,i.kt)("strong",{parentName:"p"},"rectifiers")," are mentioned and not ",(0,i.kt)("strong",{parentName:"p"},"rectify"),", so we need an additional rule during indexing that matches ",(0,i.kt)("strong",{parentName:"p"},"rectifiers")," to the stem ",(0,i.kt)("strong",{parentName:"p"},"rectify"),"."),(0,i.kt)("p",null,"The rule ",(0,i.kt)("strong",{parentName:"p"},"Z")," has a matching line for that:  "),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"SFX Z Y 4  \nSFX Z 0 rs e  \nSFX Z y iers \\[^aeiou\\]y  \nSFX Z 0 ers \\[aeiou\\]y  \nSFX Z 0 ers \\[^ey\\]  \n")),(0,i.kt)("p",null,"Here, the third line ",(0,i.kt)("inlineCode",{parentName:"p"},"SFX Z y iers [^aeiou]y")," would match the word ",(0,i.kt)("strong",{parentName:"p"},"rectifiers")," and thus enable the token filter to replace it with the base entry in the dictionary."),(0,i.kt)("h3",{id:"33-algorithmic-stemmer-improvements-over-the-hunspell-stemmer"},"3.3 Algorithmic Stemmer improvements over the Hunspell Stemmer:"),(0,i.kt)("p",null,"In most cases, the Algorithmic Stemmer outperforms the Hunspell Stemmer.\nTo find examples that explain this performance, we looked at the CACM and ADI datasets, as they showed the most significant differences."),(0,i.kt)("p",null,"First, we looked at the CACM dataset to find good examples. We calculated the F1-Score differences for both approaches with our ",(0,i.kt)("a",{parentName:"p",href:"https://search-analysis.readthedocs.io/en/latest/"},"search analysis tool")," and picked query ",(0,i.kt)("strong",{parentName:"p"},"26")," because it exhibits the greatest F1-Score difference between the two approaches.  "),(0,i.kt)("p",null,"The query text of query 26 is:"),(0,i.kt)("blockquote",null,(0,i.kt)("p",{parentName:"blockquote"},"Concurrency control mechanisms in operating systems  ")),(0,i.kt)("p",null,"The first document in the disjoint set of true positives that is not found by the Hunspell Stemmer is document ",(0,i.kt)("inlineCode",{parentName:"p"},"1198"),"."),(0,i.kt)("p",null,"The text and the title of the document are:",(0,i.kt)("br",{parentName:"p"}),"\n",(0,i.kt)("em",{parentName:"p"},"Title:")),(0,i.kt)("blockquote",null,(0,i.kt)("p",{parentName:"blockquote"},"Solution of a Problem in Concurrent Programming Control  ")),(0,i.kt)("p",null,(0,i.kt)("em",{parentName:"p"},"Text:")),(0,i.kt)("blockquote",null,(0,i.kt)("p",{parentName:"blockquote"},'A number of mainly independent sequential-cyclic processes with restricted means of communication  with each other can be made in such a way that at any moment one and only one of them is engaged in the  "critical section" of its cycle. ')),(0,i.kt)("p",null,"The document appears at position ",(0,i.kt)("inlineCode",{parentName:"p"},"3")," for the Algorithmic Stemmer and at position ",(0,i.kt)("inlineCode",{parentName:"p"},"50")," for the Hunspell Stemmer."),(0,i.kt)("p",null,"The Algorithmic Stemmer returns the following highlighted text:"),(0,i.kt)("blockquote",null,(0,i.kt)("p",{parentName:"blockquote"},"independent sequential-cyclic processes with restricted means of communication  with each other can be made ",(0,i.kt)("strong",{parentName:"p"},"in")," such a way that at any moment one and only one of them is engaged ",(0,i.kt)("strong",{parentName:"p"},"in"),' the  "critical section" of its\nAnd the following highlighted title:\n\'Solution of a Problem ',(0,i.kt)("strong",{parentName:"p"},"in")," ",(0,i.kt)("strong",{parentName:"p"},"Concurrent")," Programming ",(0,i.kt)("strong",{parentName:"p"},"Control"),"'")),(0,i.kt)("p",null,"The overall document score with the Algorithmic Stemmer of ",(0,i.kt)("strong",{parentName:"p"},"12.06")," is the sum of the term scores in the ",(0,i.kt)("strong",{parentName:"p"},"title")," field:"),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:null},"Term"),(0,i.kt)("th",{parentName:"tr",align:null},"Field"),(0,i.kt)("th",{parentName:"tr",align:null},"Score"),(0,i.kt)("th",{parentName:"tr",align:null},"Term Frequency"),(0,i.kt)("th",{parentName:"tr",align:null},"Document Frequency"))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"in"),(0,i.kt)("td",{parentName:"tr",align:null},"text"),(0,i.kt)("td",{parentName:"tr",align:null},"0.40"),(0,i.kt)("td",{parentName:"tr",align:null},"2"),(0,i.kt)("td",{parentName:"tr",align:null},"1236")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"concurr"),(0,i.kt)("td",{parentName:"tr",align:null},"title"),(0,i.kt)("td",{parentName:"tr",align:null},"5.77"),(0,i.kt)("td",{parentName:"tr",align:null},"1"),(0,i.kt)("td",{parentName:"tr",align:null},"8")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"control"),(0,i.kt)("td",{parentName:"tr",align:null},"title"),(0,i.kt)("td",{parentName:"tr",align:null},"4.30"),(0,i.kt)("td",{parentName:"tr",align:null},"1"),(0,i.kt)("td",{parentName:"tr",align:null},"38")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"in"),(0,i.kt)("td",{parentName:"tr",align:null},"title"),(0,i.kt)("td",{parentName:"tr",align:null},"1.98"),(0,i.kt)("td",{parentName:"tr",align:null},"1"),(0,i.kt)("td",{parentName:"tr",align:null},"416")))),(0,i.kt)("p",null,"Only the matches in the title field are counted for the overall document score.\nThis happens because we are using the default scoring strategy for the multi-match query that is ",(0,i.kt)("a",{parentName:"p",href:"https://www.elastic.co/guide/en/elasticsearch/reference/current/query-dsl-multi-match-query.html#multi-match-types"},(0,i.kt)("strong",{parentName:"a"},"best_field")),", which takes the highest score of one of the searched fields as the document's overall score."),(0,i.kt)("p",null,"The Hunspell Stemmer, on the other hand, returns the following highlighted text:  "),(0,i.kt)("blockquote",null,(0,i.kt)("p",{parentName:"blockquote"},"independent sequential-cyclic processes with restricted means of communication with each other can be made ",(0,i.kt)("strong",{parentName:"p"},"in")," such a way that at any moment one and only one of them is engaged ",(0,i.kt)("strong",{parentName:"p"},"in"),' the "critical section" of its',(0,i.kt)("br",{parentName:"p"}),"\n","And the following highlighted title:\nSolution of a Problem ",(0,i.kt)("strong",{parentName:"p"},"in")," Concurrent Programming ",(0,i.kt)("strong",{parentName:"p"},"Control"),"  ")),(0,i.kt)("p",null,"The overall document score with the Hunspell Stemmer of ",(0,i.kt)("strong",{parentName:"p"},"6.66")," is also the sum of the term scores in the ",(0,i.kt)("strong",{parentName:"p"},"title")," field:"),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:null},"Term"),(0,i.kt)("th",{parentName:"tr",align:null},"Field"),(0,i.kt)("th",{parentName:"tr",align:null},"Score"),(0,i.kt)("th",{parentName:"tr",align:null},"Term Frequency"),(0,i.kt)("th",{parentName:"tr",align:null},"Document Frequency"))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"in"),(0,i.kt)("td",{parentName:"tr",align:null},"text"),(0,i.kt)("td",{parentName:"tr",align:null},"0.41"),(0,i.kt)("td",{parentName:"tr",align:null},"2"),(0,i.kt)("td",{parentName:"tr",align:null},"1236")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"control"),(0,i.kt)("td",{parentName:"tr",align:null},"title"),(0,i.kt)("td",{parentName:"tr",align:null},"4.62"),(0,i.kt)("td",{parentName:"tr",align:null},"1"),(0,i.kt)("td",{parentName:"tr",align:null},"31")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"in"),(0,i.kt)("td",{parentName:"tr",align:null},"title"),(0,i.kt)("td",{parentName:"tr",align:null},"2.04"),(0,i.kt)("td",{parentName:"tr",align:null},"1"),(0,i.kt)("td",{parentName:"tr",align:null},"416")))),(0,i.kt)("img",{alt:"CACM matched terms in document 1198 for query 26",src:(0,o.Z)("img/CACM matched terms in document 1198 for query 26.svg")}),(0,i.kt)("p",null,"The Hunspell Stemmer could not match the important keyword ",(0,i.kt)("strong",{parentName:"p"},"Concurrency")," with ",(0,i.kt)("strong",{parentName:"p"},"Concurrent")," in the document title.\nWe can look at the output of the Analyze API endpoint of Elasticsearch to see how the Hunspell Stemmer handles these two words:\nRequest:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},'POST /pragmalingu-hunspell-cacm-corpus/_analyze\n{\n  "text": "concurrency concurrent"\n}\n')),(0,i.kt)("p",null,"Response:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},'{\n  "tokens" : [\n    {\n      "token" : "concurrency",\n      "start_offset" : 0,\n      "end_offset" : 11,\n      "type" : "<ALPHANUM>",\n      "position" : 0\n    },\n    {\n      "token" : "current",\n      "start_offset" : 12,\n      "end_offset" : 22,\n      "type" : "<ALPHANUM>",\n      "position" : 1\n    }\n  ]\n}\n')),(0,i.kt)("p",null,"We can see that ",(0,i.kt)("strong",{parentName:"p"},"concurrency")," is not stemmed and ",(0,i.kt)("strong",{parentName:"p"},"concurrent")," seems to be overstemmed to ",(0,i.kt)("strong",{parentName:"p"},"current"),". We can look at the Hunspell dictionary and the affix file to see which rules lead to this outcome:  "),(0,i.kt)("p",null,"For ",(0,i.kt)("strong",{parentName:"p"},"concurrency")," there is exactly one entry: ",(0,i.kt)("inlineCode",{parentName:"p"},"concurrency"),(0,i.kt)("br",{parentName:"p"}),"\n","For ",(0,i.kt)("inlineCode",{parentName:"p"},"concurrent")," we find the following rule that seems to explain the overstemming to the term ",(0,i.kt)("strong",{parentName:"p"},"current"),".",(0,i.kt)("br",{parentName:"p"}),"\n",(0,i.kt)("inlineCode",{parentName:"p"},"current/FAY"),(0,i.kt)("br",{parentName:"p"}),"\n","The rules ",(0,i.kt)("strong",{parentName:"p"},"FAY")," in the affix file are:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"PFX A Y 1\nPFX A   0     re         .\n\nPFX F Y 1\nPFX F   0     con        .\n\nSFX Y Y 1\nSFX Y   0     ly         .\n")),(0,i.kt)("p",null,"This means that the words ",(0,i.kt)("strong",{parentName:"p"},"current"),", ",(0,i.kt)("strong",{parentName:"p"},"recurrent"),", ",(0,i.kt)("strong",{parentName:"p"},"concurrent"),", and ",(0,i.kt)("strong",{parentName:"p"},"currently")," are all stemmed to ",(0,i.kt)("strong",{parentName:"p"},"current"),"."),(0,i.kt)("p",null,"This seems to indicate that the Hunspell dictionaries we are using, which are freely available for spell-checking, are not optimized for this stemmer use case."),(0,i.kt)("h3",{id:"34-standard-analyzer-improvements-over-the-hunspell-stemmer"},"3.4 Standard Analyzer improvements over the Hunspell Stemmer:"),(0,i.kt)("p",null,"On the Medline dataset, the Hunspell Stemmer performed worse than the default Standard Analyzer. We are again looking at the biggest ",(0,i.kt)("a",{parentName:"p",href:"https://colab.research.google.com/github/pragmalingu/experiments/blob/master/01_Stemming/Evaluation/Comparison_Stemming_vs_Standard_Search.ipynb#scrollTo=KLDIRhISQnls&line=2&uniqifier=1"},"F1-Score difference")," favoring the Standard Analyzer to find examples that explain the poor performance of the Hunspell Stemmer."),(0,i.kt)("p",null,"Query 1 exhibits the biggest F1-Score difference between the Standard Analyzer and the Hunspell Stemmer."),(0,i.kt)("p",null,"The query text of query 1 is:"),(0,i.kt)("blockquote",null,(0,i.kt)("p",{parentName:"blockquote"},"the crystalline lens in vertebrates, including humans.  ")),(0,i.kt)("p",null,"The first document in the disjoint true positive set of query 1 is document ",(0,i.kt)("inlineCode",{parentName:"p"},"170"),".\nThe text of document 170 is:"),(0,i.kt)("blockquote",null,(0,i.kt)("p",{parentName:"blockquote"},"identification of species-specific and organ-specific antigens in lens proteins.\nthe species-specific and organ-specific antigens of lens were investigated by gel diffusion and immunoelectrophoresis techniques.\nit  was found that rabbit antiserum to bovine lens showed cross reaction with other bovine tissues.\nthese cross-reacting antigens were the b- -  and y-crystallins .\nthere were two major and a minor organ-specific antigen in lens .\nboth the major antigens had a mobility and were        identified as the a-crystallin of lens .")),(0,i.kt)("p",null,"The Standard Analyzer returns this document at position 9 with the following highlighted matched keywords:"),(0,i.kt)("blockquote",null,(0,i.kt)("p",{parentName:"blockquote"},"identification of species-specific and organ-specific antigens ",(0,i.kt)("strong",{parentName:"p"},"in")," ",(0,i.kt)("strong",{parentName:"p"},"lens")," proteins.\n",(0,i.kt)("strong",{parentName:"p"},"the")," species-specific and organ-specific antigens of ",(0,i.kt)("strong",{parentName:"p"},"lens")," were investigated by gel diffusion reaction with other bovine tissues.\nthese cross-reacting antigens were ",(0,i.kt)("strong",{parentName:"p"},"the")," b- -  and y-crystallins there were two major and a minor organ-specific\nantigen ",(0,i.kt)("strong",{parentName:"p"},"in")," ",(0,i.kt)("strong",{parentName:"p"},"lens")," . both ",(0,i.kt)("strong",{parentName:"p"},"the")," major antigens had a mobility and were identified as ",(0,i.kt)("strong",{parentName:"p"},"the")," a-crystallin of ",(0,i.kt)("strong",{parentName:"p"},"lens"),".")),(0,i.kt)("p",null,"The overall document score with the Standard Analyzer was ",(0,i.kt)("strong",{parentName:"p"},"6.22")," and was the sum of the following term scores: "),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:null},"Term"),(0,i.kt)("th",{parentName:"tr",align:null},"Score"),(0,i.kt)("th",{parentName:"tr",align:null},"Term Frequency"),(0,i.kt)("th",{parentName:"tr",align:null},"Document Frequency"))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"the"),(0,i.kt)("td",{parentName:"tr",align:null},"0.022"),(0,i.kt)("td",{parentName:"tr",align:null},"4"),(0,i.kt)("td",{parentName:"tr",align:null},"2020")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"lens"),(0,i.kt)("td",{parentName:"tr",align:null},"6.13"),(0,i.kt)("td",{parentName:"tr",align:null},"5"),(0,i.kt)("td",{parentName:"tr",align:null},"41")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"in"),(0,i.kt)("td",{parentName:"tr",align:null},"0.07"),(0,i.kt)("td",{parentName:"tr",align:null},"2"),(0,i.kt)("td",{parentName:"tr",align:null},"987")))),(0,i.kt)("p",null,"The Hunspell Stemmer instead positioned the document ",(0,i.kt)("inlineCode",{parentName:"p"},"170")," at position 25 for query 1 and returned the following highlighted text:"),(0,i.kt)("blockquote",null,(0,i.kt)("p",{parentName:"blockquote"},"Identification of species-specific and organ-specific antigens ",(0,i.kt)("strong",{parentName:"p"},"in")," ",(0,i.kt)("strong",{parentName:"p"},"lens")," proteins.\n",(0,i.kt)("strong",{parentName:"p"},"The")," species-specific and organ-specific antigens of ",(0,i.kt)("strong",{parentName:"p"},"lens")," were investigated by gel diffusion and immunoelectrophoresis techniques.\nIt was found that rabbit antiserum to bovine ",(0,i.kt)("strong",{parentName:"p"},"lens")," showed cross reaction with other bovine organ-specific\nantigen ",(0,i.kt)("strong",{parentName:"p"},"in")," lens.Both ",(0,i.kt)("strong",{parentName:"p"},"the")," major antigens had a mobility and were identified as ",(0,i.kt)("strong",{parentName:"p"},"the")," a-crystallin of ",(0,i.kt)("strong",{parentName:"p"},"lens"),".")),(0,i.kt)("p",null,"The overall document score with the Hunspell Stemmer was ",(0,i.kt)("strong",{parentName:"p"},"5.378082")," which is slightly lower than the Standard Analyzer score:"),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:null},"Term"),(0,i.kt)("th",{parentName:"tr",align:null},"Score"),(0,i.kt)("th",{parentName:"tr",align:null},"Term Frequency"),(0,i.kt)("th",{parentName:"tr",align:null},"Document Frequency"))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"the"),(0,i.kt)("td",{parentName:"tr",align:null},"0.026"),(0,i.kt)("td",{parentName:"tr",align:null},"4"),(0,i.kt)("td",{parentName:"tr",align:null},"1018")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"l or lens"),(0,i.kt)("td",{parentName:"tr",align:null},"5.27"),(0,i.kt)("td",{parentName:"tr",align:null},"8"),(0,i.kt)("td",{parentName:"tr",align:null},"75")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"in"),(0,i.kt)("td",{parentName:"tr",align:null},"0.07"),(0,i.kt)("td",{parentName:"tr",align:null},"2"),(0,i.kt)("td",{parentName:"tr",align:null},"986")))),(0,i.kt)("img",{alt:"Medline, matched terms in document 170 for query 1.svg",src:(0,o.Z)("img/Medline, matched terms in document 170 for query 1.svg")}),(0,i.kt)("p",null,"We can see that nearly all the score differences come from the different weighting of the hits for the term ",(0,i.kt)("strong",{parentName:"p"},"lens"),".\nThe Hunspell Stemmer searches both with the original term ",(0,i.kt)("strong",{parentName:"p"},"lens")," and with the letter ",(0,i.kt)("strong",{parentName:"p"},"l"),".\nThis seems to come from the Hunspell dictionary that contains the following entry:  "),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"l/SDXTGJ  \n")),(0,i.kt)("p",null,"This entry is combined with the suffix rule X:  "),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"SFX X Y 3\nSFX X   e     ions       e\nSFX X   y     ications   y\nSFX X   0     ens        [^ey]\n")),(0,i.kt)("p",null,"Where the fourth line ",(0,i.kt)("inlineCode",{parentName:"p"},"SFX X   0     ens        [^ey]")," leads to a match with the word ",(0,i.kt)("em",{parentName:"p"},"lens"),".\nTogether, they lead to the dictionary entry ",(0,i.kt)("strong",{parentName:"p"},"l")," and the entry ",(0,i.kt)("inlineCode",{parentName:"p"},"lens/MS")," matching.\nThe term ",(0,i.kt)("strong",{parentName:"p"},"l")," has a higher document frequency of ",(0,i.kt)("strong",{parentName:"p"},"75")," than the term ",(0,i.kt)("strong",{parentName:"p"},"lens")," where the document frequency is ",(0,i.kt)("strong",{parentName:"p"},"41"),".\nElasticsearch creates a synonym query for both terms and picks the highest document frequency for the scoring when these terms match."),(0,i.kt)("p",null,"This is another indication that the freely available LibreOffice dictionaries that we are using for the Hunspell Token Filter are not optimized for the stemming use-case."),(0,i.kt)("h2",{id:"4-conclusion"},"4. Conclusion"),(0,i.kt)("p",null,"For all our tested datasets, algorithmic stemming showed considerable increases in the F1-Score gains, ranging from 1.4% - 21.9%. As algorithmic stemming is built into the language analyzers provided by Elasticsearch, it is fairly easy to use. Due to its rule-based nature, it does not come with considerable processing or memory overhead."),(0,i.kt)("p",null,"Dictionary-based stemming, as provided by the Hunspell Token Filter, is not especially easy to use since you need a good dictionary that is tailored to the stemming tasks.\nThe analysis in our discussion section indicated that the freely available Hunspell dictionaries that we used from the LibreOffice project are not really suitable for stemming.\nHunspell dictionary stemming improved over the Standard Analyzer in all but one dataset, but it could not beat the Algorithmic Stemmer with the dictionaries we tested."),(0,i.kt)("p",null,"The overall conclusions and recommendations from our experiment are:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"To get a quick and cheap boost in relevancy for your search use-case, use the ",(0,i.kt)("a",{parentName:"li",href:"https://www.elastic.co/guide/en/elasticsearch/reference/current/analysis-lang-analyzer.html"},"Language Analyzers provided by Elasticsearch"),"."),(0,i.kt)("li",{parentName:"ul"},"Only consider the ",(0,i.kt)("a",{parentName:"li",href:"https://www.elastic.co/guide/en/elasticsearch/reference/current/analysis-hunspell-tokenfilter.html"},"Hunspell Token Filter")," if you have access to a good dictionary and are sure that it will improve relevancy for your use-case."),(0,i.kt)("li",{parentName:"ul"},"Don't choose the Hunspell Token Filter with the freely available LibreOffice dictionaries over the algorithmic stemmers.  ")),(0,i.kt)("br",null),(0,i.kt)("h4",{id:"acknowledgements"},"Acknowledgements:"),(0,i.kt)("p",null,"Thanks to Kenny Hall and Miriam Rupprecht for proofreading this article."),(0,i.kt)("div",{className:"col text--right"},(0,i.kt)("em",null,(0,i.kt)("small",null,"Written by ",(0,i.kt)("strong",null,"Samy Ateia"),",  Mai 2021"))))}c.isMDXComponent=!0}}]);